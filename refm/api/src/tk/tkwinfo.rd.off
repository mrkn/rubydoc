# $Id: tkwinfo.rd,v 1.10 2000/01/22 08:52:57 arai Exp $
# Module TkWinfo is defined in tk.rb
=begin
= TkWinfo

ウィンドウに関する情報を取得するためのメソッドを集めたモジュールです。
取得する情報は比較的低レベル(ウィンドウシステム寄り)な情報です。

((-MS Windows とかはどうなる？-))

*色
 *((<TkWinfo.cells>))
 *((<TkWinfo.colormapfull>))
 *((<TkWinfo.depth>))
 *((<TkWinfo.rgb>))
 *((<TkWinfo.visual>))
 *((<TkWinfo.visualid>))
 *((<TkWinfo.visualsavailable>))
*ウィンドウの位置／サイズ
 *((<TkWinfo.containing>))
 *((<TkWinfo.geometry>))
 *((<TkWinfo.height>))
 *((<TkWinfo.reqheight>))
 *((<TkWinfo.reqwidth>))
 *((<TkWinfo.rootx>))
 *((<TkWinfo.rooty>))
 *((<TkWinfo.vrootheight>))
 *((<TkWinfo.vrootwidth>))
 *((<TkWinfo.vrootx>))
 *((<TkWinfo.vrooty>))
 *((<TkWinfo.width>))
 *((<TkWinfo.x>))
 *((<TkWinfo.y>))
*画面
 *((<TkWinfo.screen>))
 *((<TkWinfo.screencells>))
 *((<TkWinfo.screendepth>))
 *((<TkWinfo.screenheight>))
 *((<TkWinfo.screenmmheight>))
 *((<TkWinfo.screenmmwidth>))
 *((<TkWinfo.screenvisual>))
 *((<TkWinfo.screenwidth>))
*ウィンドウの状態
 *((<TkWinfo.exist?>))
 *((<TkWinfo.mapped?>))
 *((<TkWinfo.viewable>))
*ウィンドウの親子関係
 *((<TkWinfo.children>))
 *((<TkWinfo.parent>))
 *((<TkWinfo.toplevel>))
*マウスポインタ
 *((<TkWinfo.pointerx>))
 *((<TkWinfo.pointery>))
 *((<TkWinfo.pointerxy>))
*その他
 *((<TkWinfo.atom>))
 *((<TkWinfo.atomname>))
 *((<TkWinfo.classname>))
 *((<TkWinfo.id>))
 *((<TkWinfo.interps>))
 *((<TkWinfo.manager>))
 *((<TkWinfo.appname>))
 *((<TkWinfo.widget>))
 *((<TkWinfo.server>))
 *((<TkWinfo.fpixels>))
 *((<TkWinfo.pixels>))

== インクルードしているモジュール:

((<Tk>))

== extendしているモジュール:

((<Tk>))

== モジュールメソッド:

--- TkWinfo.atom(name)
    ((<アプリケーション名>))((|name|))の((<アトム>))を返します。

      require "tk"
      p TkWinfo.atom("tk")

      => 352

    ((-displayofは？-))

--- TkWinfo.atomname(id)
    アトム((|id|))に対応するアプリケーション名を返します。

      require "tk"
      p TkWinfo.atomname(TkWinfo.atom("tk"))

      => "tk"

    ((-displayofは？-))

--- TkWinfo.cells(window)
    ウィンドウ((|window|))のカラーマップのセル数を返します。

      require "tk"
      p TkWinfo.cells(Tk.root)

      => 64

--- TkWinfo.children(window)
    ウィンドウ((|window|))の子ウィンドウを配列にして返します。

    (ウィジェット階層上の子ウィンドウなので、((<TkToplevel>)) でも子ウィン
    ドウになり得ます)

      require "tk"
      TkFrame.new {
        TkButton.new(self).pack
      }
      TkToplevel.new {
        TkLabel.new(self).pack
      }
      p TkWinfo.children(Tk.root)

      => [#<TkFrame: @path=".w0000">, #<TkToplevel: @path= ... >]

--- TkWinfo.classname(window)
    ウィジェットの((<クラス>))名を返します。

      require "tk"
      p TkWinfo.classname Tk.root
      p TkWinfo.classname TkFrame.new
      p TkWinfo.classname TkFrame.new(nil, "classname"=>"Foo")

      => "Tk"
         "Frame"
         "Foo"

--- TkWinfo.colormapfull(window)
    ウィンドウに割り当てられたカラーマップに空きがなければ真を返します。

      require "tk"
      p TkWinfo.colormapfull Tk.root

      => false

--- TkWinfo.containing(rootX, rootY)
    指定した位置にあるウィンドウを返します。

      require "tk"
      TkLabel.new {
        text "Click Here!"
        bind "1", proc {|rootx, rooty|
          p TkWinfo.containing(rootx, rooty)
          exit
        }, "%X %Y"
      }.pack
      Tk.mainloop

      => #<TkLabel: @path=".w0000", @cmdtbl=["c0000"]>

    ((-displayofは？-))

--- TkWinfo.depth(window)
    ウィンドウの深さ(1ピクセルあたりのビット数)を返します。

      require "tk"
      p TkWinfo.depth TkLabel.new

      => 16

--- TkWinfo.exist?(window)
    ウィンドウが存在しているかどうかを返します。

      require "tk"
      l = TkLabel.new
      p TkWinfo.exist? l
      l.destroy
      p TkWinfo.exist? l

      => true
         false

--- TkWinfo.fpixels(window, number)
    距離((|number|))が何ピクセルかを浮動小数で返します。((<TkWinfo.pixels>))

      require "tk"
      p TkWinfo.fpixels Tk.root, 1
      p TkWinfo.fpixels Tk.root, "1c"  # cm
      p TkWinfo.fpixels Tk.root, "1m"  # mm
      p TkWinfo.fpixels Tk.root, "1i"  # inch

      p TkWinfo.fpixels Tk.root, "2.54c"  # 1 inch

      => 1.0
         29.56120092
         2.956120092
         75.08545035
         75.08545035

--- TkWinfo.geometry(window)
    ウィンドウの((<ジオメトリ>))を返します。

    ((<Tk::Wm#geometry>))はウィンドウのフレーム(タイトルバーなど)の位置を
    返すので、このメソッドとは結果が異なる場合があります。

      require "tk"
      p Tk.root.geometry 
      p TkWinfo.geometry Tk.root
      Tk.after 1000 do
        p Tk.root.geometry
        p TkWinfo.geometry Tk.root
        exit
      end
      Tk.mainloop

      =>"1x1+0+0"
        "1x1+0+0"
        "200x200+323+374"
        "200x200+328+396"

--- TkWinfo.height(window)
    ウィンドウの高さを返します。

      require "tk"
      Tk.after 1000 do
        p TkWinfo.height Tk.root
        p TkWinfo.width Tk.root
        exit
      end
      Tk.mainloop

      => 200
         200

--- TkWinfo.id(window)
    ウィンドウの((<リソースID>))を返します。((<TkWinfo.widget>))

      require "tk"
      p TkWinfo.id Tk.root
      p TkWinfo.widget TkWinfo.id Tk.root

      => "0x400000e"
         #<TkRoot: @path=".">

--- TkWinfo.interps(window=nil)
    実行しているTcl/Tkインタプリタのアプリケーション名を配列にして返します。
    ウィンドウを指定すると、そのウィンドウがあるスクリーン上で実行している
    ものを返します。

      require "tk"
      ip = TclTkIp.new
      p TkWinfo.interps

      => ["tk #2", "tk"]

--- TkWinfo.mapped?(window)
    ウィンドウが((<マップ>))されていれば真を返します。
    ((<TkWinfo.viewable>))

      require "tk"
      p TkWinfo.mapped? Tk.root
      Tk.after 1000 do
        p TkWinfo.mapped? Tk.root
        exit
      end
      Tk.mainloop

      => false
         true

--- TkWinfo.manager(window)
    ウィンドウ配置を決めている((<ジオメトリマネージャ>))の名前を返します。
    ((<TkRoot>))や((<TkToplevel>))の場合はウィンドウマネージャを表す文字列
    (({"wm"}))を返します。

      require "tk"
      p TkWinfo.manager Tk.root
      p TkWinfo.manager TkToplevel.new
      p TkWinfo.manager TkLabel.new.pack
      p TkWinfo.manager TkLabel.new.grid
      p TkWinfo.manager TkLabel.new.place("x"=>0)

      => "wm"
         "wm"
         "pack"
         "grid"
         "place"

--- TkWinfo.appname(window)
    ウィンドウの名前(((<パス>))名の要素)を返します。ルートウィジェットでは
    アプリケーション名を返します。((<TkCore.appname>))

      require "tk"
      p TkWinfo.appname Tk.root
      p TkWinfo.appname TkLabel.new.pack

      => "tk"
         "w0001"

--- TkWinfo.parent(window)
    ウィンドウの親ウィンドウを返します。ルートウィジェットを指定した場合
    (({nil}))を返します。

      require "tk"
      p TkWinfo.parent TkRoot.new
      p TkWinfo.parent TkToplevel.new

      => nil
         #<TkRoot: @path=".">

--- TkWinfo.widget(id)
    ウィンドウの((<リソースID>))からウィンドウを返します。((<TkWinfo.id>))

      require "tk"
      p TkWinfo.id Tk.root
      p TkWinfo.widget TkWinfo.id Tk.root

      => 62914574
         #<TkRoot: @path=".">

    ((-displayofは？-))

--- TkWinfo.pixels(window, number)
    距離((|number|))が何ピクセルかを整数で返します。((<TkWinfo.fpixels>))

      require "tk"
      p TkWinfo.pixels Tk.root, 1
      p TkWinfo.pixels Tk.root, "1c"  # cm
      p TkWinfo.pixels Tk.root, "1m"  # mm
      p TkWinfo.pixels Tk.root, "1i"  # inch

      p TkWinfo.pixels Tk.root, "2.54c"  # 1 inch

      => 1
         30
         3
         75
         75

--- TkWinfo.reqheight(window)
    ウィンドウが要求する高さを返します。

      require "tk"
      p TkWinfo.height Tk.root
      p TkWinfo.reqheight Tk.root

      => 1
         200

--- TkWinfo.reqwidth(window)
    ウィンドウが要求する幅を返します。

      require "tk"
      p TkWinfo.width Tk.root
      p TkWinfo.reqwidth Tk.root

      => 1
         200

--- TkWinfo.rgb(window, color)
    色((|color|))に対応するRGB値を配列で返します。

      require "tk"
      p TkWinfo.rgb Tk.root, "black"
      p TkWinfo.rgb Tk.root, "white"
      p TkWinfo.rgb Tk.root, "red"
      p TkWinfo.rgb Tk.root, "green"
      p TkWinfo.rgb Tk.root, "blue"
      p TkWinfo.rgb Tk.root, "gray"
      p TkWinfo.rgb Tk.root, "#0a0a0a"

      => [0, 0, 0]
         [65535, 65535, 65535]
         [65535, 0, 0]
         [0, 65535, 0]
         [0, 0, 65535]
         [48830, 48830, 48830]
         [2114, 2114, 2114]


--- TkWinfo.rootx(window)
    ウィンドウの基準位置(左上角)のルートウィンドウ上でのX座標を返します。
    ((-ウィンドウの飾りは考慮しない？-))

      require "tk"
      Tk.root.geometry("+0+0")
      p TkWinfo.rootx Tk.root
      p TkWinfo.rooty Tk.root
      Tk.after 1000, proc {
        p TkWinfo.rootx Tk.root
        p TkWinfo.rooty Tk.root
        exit
      }
      Tk.mainloop

      => 0
         0
         5
         22

--- TkWinfo.rooty(window)
    ウィンドウの基準位置(左上角)のルートウィンドウ上でのX座標を返します。

--- TkWinfo.screen(window)
    ウィンドウが存在するスクリーン名を返します。

      require "tk"
      p TkWinfo.screen Tk.root

      => ":0.0"

--- TkWinfo.screencells(window)
    ウィンドウが存在するスクリーンのデフォルトカラーマップのセル数を返しま
    す。

      require "tk"
      p TkWinfo.screencells Tk.root

      => 64

--- TkWinfo.screendepth(window)
    ウィンドウが存在するスクリーンのデフォルトの深さを返します。

      require "tk"
      p TkWinfo.screendepth Tk.root

      => 16

--- TkWinfo.screenheight (window)
    ウィンドウが存在するスクリーンの高さ(ピクセル)を返します。

      require "tk"
      p TkWinfo.screenheight Tk.root

      => 1024

--- TkWinfo.screenmmheight(window)
    ウィンドウが存在するスクリーンの高さ(ミリメートル)を返します。

      require "tk"
      p TkWinfo.screenheight Tk.root
      p TkWinfo.screenmmheight Tk.root
      p TkWinfo.fpixels Tk.root, "#{TkWinfo.screenmmheight Tk.root}m"

      => 1024
         347
         1025.773672

    ((-どこの誤差？-))

--- TkWinfo.screenmmwidth(window)
    ウィンドウが存在するスクリーンの幅(ミリメートル)を返します。

      require "tk"
      p TkWinfo.screenwidth Tk.root
      p TkWinfo.screenmmwidth Tk.root
      p TkWinfo.fpixels Tk.root, "#{TkWinfo.screenmmwidth Tk.root}m"

      => 1280
         433
         1280.0

--- TkWinfo.screenvisual(window)
    ウィンドウが存在するスクリーンのデフォルトのvisualクラスを返します。
    visualクラスは以下のうちの何れかです。

    *"directcolor"
    *"grayscale"
    *"pseudocolor"
    *"staticcolor"
    *"staticgray"
    *"truecolor"

    ((-ダミー-))

      require "tk"
      p TkWinfo.screenvisual Tk.root

      => "truecolor"

--- TkWinfo.screenwidth(window)
    ウィンドウが存在するスクリーンの幅(ピクセル)を返します。

      require "tk"
      p TkWinfo.screenwidth Tk.root

      => 1280

--- TkWinfo.server(window)
    ウィンドウが存在するスクリーンのサーバ情報(バージョン、ベンダ、ベンダ
    バージョン)を文字列で返します。

      require "tk"
      p TkWinfo.server Tk.root

      => "X11R0 The XFree86 Project, Inc 3320"

    ((- R0 ？-))

--- TkWinfo.toplevel(window)
    ウィンドウが((<TkToplevel>))上に配置されていればその(({TkToplevel}))ウィ
    ンドウを返します。

      require "tk"
      p TkWinfo.toplevel TkFrame.new.pack

      TkToplevel.new {
        p TkWinfo.toplevel TkFrame.new(self) {
          p TkWinfo.toplevel TkFrame.new(self).pack
        }.pack
      }

      => nil
         #<TkToplevel: @classname=nil, @path=".w0001", @screen=nil>
         #<TkToplevel: @classname=nil, @path=".w0001", @screen=nil>

--- TkWinfo.visual(window)
    ウィンドウの visual クラスを返します。

      require "tk"
      p TkWinfo.visual TkFrame.new
      p TkWinfo.visual TkToplevel.new(nil, {"visual"=>"grayscale"})

      => "truecolor"
      error--> tk.rb:510:in `_invoke': couldn't find an appropriate visual (RuntimeError)

    ((-truecolor以外のvisualクラスを指定する方法は？-))

--- TkWinfo.visualid(window)
    ウィンドウの visual ID を返します。

      require "tk"
      p TkWinfo.visualid TkFrame.new
      p TkWinfo.visualid TkToplevel.new(nil, {"visual"=>"grayscale"})

      => "0x22"
      error--> tk.rb:510:in `_invoke': couldn't find an appropriate visual (RuntimeError)

    ((-truecolor以外のvisualクラスを指定する方法は？-))

--- TkWinfo.visualsavailable(window, includeids=false)
    ウィンドウのあるスクリーン上で指定可能な以下の配列

     [visualクラス , 深さ(1ピクセルあたりのビット数), visual ID]

    の配列を返します。ただし、visual IDは、引数((|includeids|))が真の場合
    にしか要素に含まれません。

    Tkの古い版では(少なくともバージョン 4.0 では)、visual ID を要素に持て
    ません。((-正確にどのバージョンから"includeids"が指定可能になったか-))

      require "tk"
      p TkWinfo.visualsavailable TkFrame.new
      p TkWinfo.visualsavailable TkFrame.new, true

      => [["truecolor", 16]]
         [["truecolor", 16, "0x22"]]

--- TkWinfo.vrootheight(window)
    ウィンドウのあるスクリーンの高さを返します。((<仮想画面>))を考慮します。

      require "tk"
      p TkWinfo.vrootheight Tk.root

      => 1024

--- TkWinfo.vrootwidth(window)
    ウィンドウのあるスクリーンの幅を返します。((<仮想画面>))を考慮します。

      require "tk"
      p TkWinfo.vrootwidth Tk.root

      => 1280

--- TkWinfo.vrootx(window)
    ウィンドウのあるスクリーンのX座標を返します。((<仮想画面>))を考慮します。

      require "tk"
      p TkWinfo.vrootx Tk.root

      => 0

--- TkWinfo.vrooty(window)
    ウィンドウのあるスクリーンのY座標を返します。((<仮想画面>))を考慮します。

      require "tk"
      p TkWinfo.vrooty Tk.root

      => 0

--- TkWinfo.width(window)
    ウィンドウの幅を返します。

      require "tk"
      Tk.after 1000 do
        p TkWinfo.height Tk.root
        p TkWinfo.width Tk.root
        exit
      end
      Tk.mainloop

      => 200
         200

--- TkWinfo.x(window)
    ウィンドウの基準位置(左上角)の親ウィンドウ上でのX座標を返します。
    ((<TkRoot>))や((<TkToplevel>))のウィンドウでは((<TkWinfo.rootx>))と同じです。

      require "tk"
      top = TkToplevel.new
      label = TkLabel.new {text "label"}.place("x"=>100, "y"=>100)
      Tk.after 1000 do
        print TkWinfo.x(Tk.root), '+', TkWinfo.x(label), '=', TkWinfo.rootx(label), "\n"
        print TkWinfo.y(Tk.root), '+', TkWinfo.y(label), '=', TkWinfo.rooty(label), "\n"
        exit
      end
      Tk.mainloop

      => 226+100=326
         464+100=564

--- TkWinfo.y(window)
    ウィンドウの基準位置(左上角)の親ウィンドウ上でのY座標を返します。
    ((<TkRoot>))や((<TkToplevel>))のウィンドウでは((<TkWinfo.rooty>))と同じです。

--- TkWinfo.viewable(window)
    指定したウィンドウとその先祖ウィンドウ(すべての親)が((<マップ>))されて
    いれば真を返します。((<TkWinfo.mapped?>))

      require "tk"
      root  = TkRoot.new
      top   = TkToplevel.new

      label1 = TkLabel.new(root) { text "label1" }.pack
      label2 = TkLabel.new(top)  { text "label2" }.pack

      root.withdraw
      Tk.after 1000, proc {
        p TkWinfo.viewable root
        p TkWinfo.viewable label1
        p TkWinfo.viewable top
        p TkWinfo.viewable label2
        exit
      }
      Tk.mainloop

      => false
         false
         true
         true

--- TkWinfo.pointerx(window)
    ウィンドウがあるスクリーン上のマウスポインタのX座標を返します。
    マウスポインタがスクリーン上にない場合-1を返します((-どういう場合？-))。

      require "tk"
      p TkWinfo.pointerx Tk.root
      p TkWinfo.pointery Tk.root
      p TkWinfo.pointerxy Tk.root

      => 493
         556
         [493, 556]

--- TkWinfo.pointery(window)
    ウィンドウがあるスクリーン上のマウスポインタのY座標を返します。
    マウスポインタがスクリーン上にない場合-1を返します((-どういう場合？-))。

--- TkWinfo.pointerxy(window)
    (('[TkWinfo.pointerx, TkWinfo.pointery]'))である配列を返します。

== メソッド:

このモジュールのインスタンスメソッドはすべて、同名のモジュールメソッド
と同じです。ただし、名前に"winfo_"が付く点と引数(({window}))を持つモ
ジュールメソッドは代りに(({self}))を使う点が異なります。

--- TkWinfo#winfo_atom(name)
    ((<TkWinfo.atom>))

--- TkWinfo#winfo_atomname(id)
    ((<TkWinfo.atomname>))

--- TkWinfo#winfo_cells
    ((<TkWinfo.cells>))

--- TkWinfo#winfo_children
    ((<TkWinfo.children>))

--- TkWinfo#winfo_classname
    ((<TkWinfo.classname>))

--- TkWinfo#winfo_colormapfull
    ((<TkWinfo.colormapfull>))

--- TkWinfo#winfo_containing(x, y)
    ((<TkWinfo.containing>))

--- TkWinfo#winfo_depth
    ((<TkWinfo.depth>))

--- TkWinfo#winfo_exist?
    ((<TkWinfo.exist?>))

--- TkWinfo#winfo_fpixels(number)
    ((<TkWinfo.fpixels>))

--- TkWinfo#winfo_geometry
    ((<TkWinfo.geometry>))

--- TkWinfo#winfo_height
    ((<TkWinfo.height>))

--- TkWinfo#winfo_id
    ((<TkWinfo.id>))

--- TkWinfo#winfo_interps
    ((<TkWinfo.interps>))

--- TkWinfo#winfo_mapped?
    ((<TkWinfo.mapped?>))

--- TkWinfo#winfo_manager
    ((<TkWinfo.manager>))

--- TkWinfo#winfo_appname
    ((<TkWinfo.appname>))

--- TkWinfo#winfo_parent
    ((<TkWinfo.parent>))

--- TkWinfo#winfo_widget(id)
    ((<TkWinfo.widget>))

--- TkWinfo#winfo_pixels(number)
    ((<TkWinfo.pixels>))

--- TkWinfo#winfo_reqheight
    ((<TkWinfo.reqheight>))

--- TkWinfo#winfo_reqwidth
    ((<TkWinfo.reqwidth>))

--- TkWinfo#winfo_rgb(color)
    ((<TkWinfo.rgb>))

--- TkWinfo#winfo_rootx
    ((<TkWinfo.rootx>))

--- TkWinfo#winfo_rooty
    ((<TkWinfo.rooty>))

--- TkWinfo#winfo_screen
    ((<TkWinfo.screen>))

--- TkWinfo#winfo_screencells
    ((<TkWinfo.screencells>))

--- TkWinfo#winfo_screendepth
    ((<TkWinfo.screendepth>))

--- TkWinfo#winfo_screenheight
    ((<TkWinfo.screenheight>))

--- TkWinfo#winfo_screenmmheight
    ((<TkWinfo.screenmmheight>))

--- TkWinfo#winfo_screenmmwidth
    ((<TkWinfo.screenmmwidth>))

--- TkWinfo#winfo_screenvisual
    ((<TkWinfo.screenvisual>))

--- TkWinfo#winfo_screenwidth
    ((<TkWinfo.screenwidth>))

--- TkWinfo#winfo_server
    ((<TkWinfo.server>))

--- TkWinfo#winfo_toplevel
    ((<TkWinfo.toplevel>))

--- TkWinfo#winfo_visual
    ((<TkWinfo.visual>))

--- TkWinfo#winfo_visualid
    ((<TkWinfo.visualid>))

--- TkWinfo#winfo_visualsavailable(includeids=false)
    ((<TkWinfo.visualsavailable>))

--- TkWinfo#winfo_vrootheight
    ((<TkWinfo.vrootheight>))

--- TkWinfo#winfo_vrootwidth
    ((<TkWinfo.vrootwidth>))

--- TkWinfo#winfo_vrootx
    ((<TkWinfo.vrootx>))

--- TkWinfo#winfo_vrooty
    ((<TkWinfo.vrooty>))

--- TkWinfo#winfo_width
    ((<TkWinfo.width>))

--- TkWinfo#winfo_x
    ((<TkWinfo.x>))

--- TkWinfo#winfo_y
    ((<TkWinfo.y>))

--- TkWinfo#winfo_viewable
    ((<TkWinfo.viewable>))

--- TkWinfo#winfo_pointerx
    ((<TkWinfo.pointerx>))

--- TkWinfo#winfo_pointery
    ((<TkWinfo.pointery>))

--- TkWinfo#winfo_pointerxy
    ((<TkWinfo.pointerxy>))

=end
