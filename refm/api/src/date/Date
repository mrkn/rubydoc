= class Date < Object

include Comparable

日付だけでなく時刻も扱える Date のサブクラス [[c:DateTime]] も利用できます。

=== 簡単なつかいかた

  require 'date'

  a = Date.new(1993, 2, 24)
  b = Date.parse('1993-02-24')
  b += 10

  b - a            #=> 10
  b.year           #=> 1993
  b.strftime('%a') #=> "Sat"

  yesterday = Date.today - 1

=== 用語の定義

いくつか用語の定義は、ISO 8601、および JIS X 0301 に基づきます。

==== 暦日付

暦日付は、暦年、暦月、および暦月の中の序数によって
指定される特定の日の日付です。

つまり、ごく当たり前の年月日による日付です。

==== 年間通算日 (年日付)

年間通算日 (年日付) は、暦年、および暦年の中の序数によって指定される
特定の日の日付です。

==== 暦週日付

暦週日付は、暦週と暦年中の序数による日付です。

暦週は、暦年中の序数によって指定される特定の7日の期間であり、月曜から
始まります。その年の第1暦週は、最初の木曜日を含む週とします。これは、
1月4日を含む週と同じです。

==== ユリウス日

ユリウス日は紀元前4713年1月1日 (ユリウス暦) 正午 (グリニッジ平均時) を
暦元とした通日 (経過日数) です。

この文書で、天文学的なユリウス日とは、本来のユリウス日と同じものです。
また、年代学的なユリウス日とは、地方時における零時を一日の始まりとする
流儀です。

この文書で、単に「ユリウス日」といった場合、それは本来のユリウス日でな
く、「年代学的なユリウス日」を意味しています。

==== 修正ユリウス日

修正ユリウス日は西暦1858年11月17日 (グレゴリオ暦) 零時 (協定世界時) を
暦元とした通日 (経過日数) です。

この文書で、天文学的な修正ユリウス日とは、本来の修正ユリウス日と同じも
のです。また、年代学的な修正ユリウス日とは、地方時における零時を一日の
始まりとする流儀です。

この文書で、単に「修正ユリウス日」といった場合、それは本来の修正ユリウ
ス日でなく、「年代学的な修正ユリウス日」を意味しています。

== Constants

--- MONTHNAMES
月の名称(January, February ... )

MONTHNAMES[0] == nil で MONTHNAMES[1] == "January" です。

--- DAYNAMES
曜日の名称(Sunday, Monday ... )

DAYNAMES[0] == "Sunday" です。

--- ABBR_MONTHNAMES
月の省略名(Jan, Feb ... )

ABBR_MONTHNAMES[0] == nil で ABBR_MONTHNAMES[1] == "Jan" です。

--- ABBR_DAYNAMES
曜日の省略名(Sun, Mon ... )

ABBR_DAYNAMES[0] == "Sun" です。

--- ENGLAND
英国がグレゴリオ暦をつかい始めた日 (1752年9月14日) をあらわすユリウス日です。
この "ENGLAND" の名前は、UNIX の [[man:cal(1)]] の記述に由来します。

ちなみに、本実装で英国の改暦日を尊重する姿勢がみられるのは前実装からの影響です。
前実装が英国の改暦日を尊重していたのは、おそらく [[man:cal(1)]] の影響です。
もっとも本実装で一番に尊重されているのは、伊国の改暦日であり、多くの場合、
改暦日の既定値は [[m:Date::ITALY]] です。

--- GREGORIAN
常にグレゴリオ暦であることを示します。
改暦日は無限の過去にあると考えられます。

--- ITALY
伊国がグレゴリオ暦をつかい始めた日 (1582年10月15日) をあらわすユリウス日です。

--- JULIAN
常にユリウス暦であることを示します。
改暦日は無限の未来にあると考えられます。

== Class Methods

#@since 1.8.0
#@#? --- ajd_to_amjd(ajd) -> Rational

#@#? --- ajd_to_jd(ajd, offset=0) -> Array

#@#? --- amjd_to_ajd(amjd) -> Rational
#@end

#@since 1.8.0
--- civil(year = -4712, mon = 1, mday = 1, start = Date::ITALY) -> Date
#@else
--- new3(year = -4712, mon = 1, mday = 1, start = Date::ITALY) -> Date
#@end
--- new(year = -4712, mon = 1, mday = 1, start = Date::ITALY) -> Date
暦日付に相当する日付オブジェクトを生成します。

このクラスでは、紀元前の年を天文学の流儀で勘定します。
1年の前は零年、零年の前は-1年、のようにします。
月、および月の日は負、
または正の数でなければなりません (負のときは最後からの序数)。
零であってはなりません。

最後の引数は、グレゴリオ暦をつかい始めた日をあらわすユリウス日です。
#@if (version < "1.8.6")
グレゴリオ暦の指定として真、ユリウス暦の指定として偽を与えることもできます。
#@end
省略した場合は、[[m:Date::ITALY]] (1582年10月15日) になります。

@param year 年
@param mon 月
@param mday 日
@param start グレゴリオ暦をつかい始めた日をあらわすユリウス日
@raise ArgumentError 正しくない日付

[[m:Date.jd]] も参照してください。

#@#? --- civil_to_jd(year, mon, mday, start = Date::GREGORIAN) -> Numeric

#@since 1.9.0
--- commercial(cwyear = -4712, cweek = 1, cwday = 1, start = Date::ITALY) -> Date
#@since 1.8.0
--- commercial(cwyear = 1582, cweek = 41, cwday = 5, start = Date::ITALY) -> Date
#@else
--- neww(cwyear = 1582, cweek = 41, cwday = 5, start = Date::ITALY) -> Date
#@end
暦週日付に相当する日付オブジェクトを生成します。

週、および週の日 (曜日) は負、
または正の数でなければなりません(負のときは最後からの序数)。
零であってはなりません。

このメソッドに改暦前の日付を与えることはできません。

@param cwyear 年
@param cweek 週
@param cwday 週の日 (曜日)
@param start グレゴリオ暦をつかい始めた日をあらわすユリウス日
@raise ArgumentError 正しくない日付

[[m:Date.jd]]、および [[m:Date.new]] も参照してください。

#@#? --- commercial_to_jd(cwyear, cweek, cwday, start = Date::GREGORIAN) -> Numeric

#@since 1.8.0
#@#? --- day_fraction_to_time(fr) -> Array
#@end

#@since 1.8.6
--- gregorian? (jd, start) -> bool
#@else
--- ns? (jd, start) -> bool
#@end

@param jd ユリウス日
@param start グレゴリオ暦をつかい始めた日をあらわすユリウス日

--- gregorian_leap? (year) -> bool
--- leap? (year) -> bool
グレゴリオ暦の閏年なら真を返します。

@param year 年

#@since 1.8.6
--- jd(jd = 0, start = Date::ITALY) -> Date
#@else
--- new1(jd = 0, start = Date::ITALY) -> Date
#@end
ユリウス日に相当する日付オブジェクトを生成します。

このクラスのいくつかの重要なメソッドで、
負のユリウス日は保証されません。

@param jd ユリウス日
@param start グレゴリオ暦をつかい始めた日をあらわすユリウス日

[[m:Date.new]] も参照してください。

#@since 1.8.0
#@#? --- jd_to_ajd(jd, fraction, offset = 0) -> Rational
#@end

#@#? --- jd_to_civil(jd, start = Date::GREGORIAN) -> Array

#@#? --- jd_to_commercial(jd, start = Date::GREGORIAN) -> Array

#@#? --- jd_to_ld(jd) -> Numeric

#@#? --- jd_to_mjd(jd) -> Numeric

#@#? --- jd_to_ordinal(jd, start = Date::GREGORIAN) -> Array

#@#? --- jd_to_wday(jd) -> Numeric

#@since 1.8.6
#@#? --- jd_to_weeknum(jd, f = 0, start = Date::GREGORIAN) -> Array
#@end

#@since 1.8.6
#@#? --- julian? (jd, start) -> bool
#@else
#@#? --- os? (jd, start) -> bool
#@end

@param jd ユリウス日
@param start グレゴリオ暦をつかい始めた日をあらわすユリウス日

--- julian_leap? (year) -> bool
ユリウス暦の閏年なら真を返します。

西暦4年は真になりますが、
これは歴史的には正しくありません。

@param year 年

#@#? --- ld_to_jd(ld) -> Numeric

#@#? --- mjd_to_jd(mjd) -> Numeric

#@since 1.8.6
#@#? --- new!(ajd = 0, offset = 0, start = Date::ITALY) -> Date
#@else
#@#? --- new0(ajd = 0, offset = 0, start = Date::ITALY) -> Date
#@end

#@since 1.8.0
--- ordinal(year = -4712, yday = 1, start = Date::ITALY) -> Date
#@else
--- new2(year = -4712, yday = 1, start = Date::ITALY) -> Date
#@end
年間通算日 (年日付) に相当する日付オブジェクトを生成します。

年の日は負、
または正の数でなければなりません (負のときは最後からの序数)。
零であってはなりません。

@param year 年
@param yday 年の日
@param start グレゴリオ暦をつかい始めた日をあらわすユリウス日
@raise ArgumentError 正しくない日付

[[m:Date.jd]]、および [[m:Date.new]] も参照してください。

#@#? --- ordinal_to_jd(year, yday, start = Date::GREGORIAN) -> Numeric

#@since 1.8.0
--- _parse(str, complete = false) -> Hash
このメソッドは [[m:Date.parse]] と似ていますが、日付オブジェクトを生成せずに、
見いだした要素をハッシュで返します。

@param str 日付をあらわす文字列
@param complete 年を補完するか

[[m:Date.parse]] も参照してください。

--- parse(str = '-4712-01-01', complete = false, start = Date::ITALY) -> Date
与えられた日付表現を解析し、
その情報に基づいて日付オブジェクトを生成します。

省略できる最後の引数が真で、年が00から99の範囲であれば、
年の下2桁表現であるとみなしこれを補います。
なお、省略した場合は、偽とみなします。

@param str 日付をあらわす文字列
@param complete 年を補完するか
@param start グレゴリオ暦をつかい始めた日をあらわすユリウス日
@raise ArgumentError 正しくない日付

[[m:Date._parse]] も参照してください。

--- _strptime(str, format = '%F') -> Hash
このメソッドは [[m:Date.strptime]] と似ていますが、日付オブジェクトを生成せずに、
見いだした要素をハッシュで返します。

@param str 日付をあらわす文字列
@param format 書式

--- strptime(str = '-4712-01-01', format = '%F', start = Date::ITALY) -> Date
与えられた雛型で日付表現を解析し、
その情報に基づいて日付オブジェクトを生成します。

@param str 日付をあらわす文字列
@param format 書式
@param start グレゴリオ暦をつかい始めた日をあらわすユリウス日
@raise ArgumentError 正しくない日付

[[m:Date._strptime]] も参照してください。

また [[man:strptime(3)]]、および [[m:Date#strftime]] も参照してください。
#@end

#@since 1.8.0
#@#? --- time_to_day_fraction(hour, minute, second) -> Numeric
#@end

--- today(start = Date::ITALY) -> Date
現在の日付に相当する日付オブジェクトを生成します。

#@since 1.9.0
--- valid_civil? (year, mon, mday, start = Date::GREGORIAN) -> bool
--- valid_date? (year, mon, mday, start = Date::GREGORIAN) -> bool
#@since 1.8.0
--- valid_civil? (year, mon, mday, start = Date::GREGORIAN) -> Numeric|nil
--- valid_date? (year, mon, mday, start = Date::GREGORIAN) -> Numeric|nil
#@else
--- exist? (year, mon, mday, start = Date::GREGORIAN) -> Numeric|nil
--- exist3? (year, mon, mday, start = Date::GREGORIAN) -> Numeric|nil
#@end
#@since 1.9.0
正しい暦日付であれば真、そうでないなら偽を返します。
#@else
正しい暦日付であれば、相当するユリウス日を返します。
そうでないなら、偽を返します。
#@end

@param year 年
@param mon 月
@param mday 日
@param start グレゴリオ暦をつかい始めた日をあらわすユリウス日

[[m:Date.jd]]、および [[m:Date.civil]] も参照してください。

#@since 1.9.0
--- valid_commercial? (cwyear, cweek, cwday, start = Date::GREGORIAN) -> bool
#@since 1.8.0
--- valid_commercial? (cwyear, cweek, cwday, start = Date::GREGORIAN) -> Numeric|nil
#@else
--- existw? (cwyear, cweek, cwday, start = Date::GREGORIAN) -> Numeric|nil
#@end
#@since 1.9.0
正しい暦週日付であれば真、そうでないなら偽を返します。
#@else
正しい暦週日付であれば、相当するユリウス日を返します。
そうでないなら、偽を返します。
#@end

@param cwyear 年
@param cweek 週
@param cwday 週の日 (曜日)
@param start グレゴリオ暦をつかい始めた日をあらわすユリウス日

[[m:Date.jd]]、および [[m:Date.commercial]] も参照してください。

#@since 1.9.0
--- valid_jd? (jd, start = Date::GREGORIAN) -> bool
#@since 1.8.0
--- valid_jd? (jd, start = Date::GREGORIAN) -> Numeric|nil
#@else
--- exist1? (jd, start = Date::GREGORIAN) -> Numeric|nil
#@end
#@since 1.9.0
真を返します。
#@else
ひとつ目の引数をそのまま返します。
#@end

対称性のため用意されていますが、実際的に意味はありません。

@param jd ユリウス日
@param start グレゴリオ暦をつかい始めた日をあらわすユリウス日

[[m:Date.jd]] も参照してください。

#@since 1.9.0
--- valid_ordinal? (year, yday, start = Date::GREGORIAN) -> bool
#@since 1.8.0
--- valid_ordinal? (year, yday, start = Date::GREGORIAN) -> Numeric|nil
#@else
--- exist2? (year, yday, start = Date::GREGORIAN) -> Numeric|nil
#@end
#@since 1.9.0
正しい年間通算日 (年日付) であれば真、そうでないなら偽を返します。
#@else
正しい年間通算日 (年日付) であれば、相当するユリウス日を返します。
そうでないなら、偽を返します。
#@end

@param year 年
@param yday 年の日
@param start グレゴリオ暦をつかい始めた日をあらわすユリウス日

[[m:Date.jd]]、および [[m:Date.ordinal]] も参照してください。

#@since 1.8.6
#@#? --- weeknum_to_jd(year, week, day, f = 0, start = Date::GREGORIAN) -> Numeric
#@end

#@since 1.8.0
#@#? --- zone_to_diff(zone) -> Rational
#@end

== Instance Methods

--- + (n) -> Date
self から n 日後の日付オブジェクトを返します。
n は数値でなければなりません。

@param n 日数をあらわす基数
@raise 数値でない

--- - (x) -> Rational|Date
x が日付オブジェクトなら、ふたつの差を返します。
あるいは
x が数値ならば、self より x 日前の日付を返します。

@param x 日数をあらわす基数、あるいは日付オブジェクト
@raise 数値でも日付オブジェクトでもない

--- << (n) -> Date
self より n ヶ月前の日付オブジェクトを返します。
n は数値でなければなりません。

@param n 月数をあらわす基数

#@since 1.9.0
[[m:Date#prev_month]] も参照してください。
#@end

--- <=> (other) -> Integer
ふたつを比較し、-1、零、あるいは 1 を返します。
other は日付オブジェクトか、
天文学的なユリウス日をあらわす数値でなければなりません。

@param other 日付オブジェクト

--- === (other) -> bool
同じ日なら真を返します。

@param other 日付オブジェクト

--- >> (n) -> Date
self から n ヶ月後の日付オブジェクトを返します。
n は数値でなければなりません。

@param n 月数をあらわす基数

#@since 1.9.0
[[m:Date#next_month]] も参照してください。
#@end

#@since 1.8.0
--- ajd -> Rational
このメソッドは [[m:Date#jd]] と似ていますが、天文学的なユリウス日を返します。
時刻を含みます。

--- amjd -> Rational
このメソッドは [[m:Date#mjd]] と似ていますが、天文学的な修正ユリウス日を返します。
時刻を含みます。
#@end

--- asctime -> String
--- ctime -> String
[[man:asctime(3)]] 書式の文字列を返します (ただし、末尾の "\n\0" は除く)。

--- cwday -> Integer
暦週の日 (曜日) を返します (1-7、月曜は1)。

--- cweek -> Integer
暦週を返します (1-53)。

--- cwyear -> Integer
暦週における年を返します。

#@#? --- day_fraction -> Rational

--- downto(min){|date| ...} -> Date
このメソッドは、step(min, -1){|date| ...} と等価です。

#@since 1.9.0
1.9.0 以降では、ブロックが与えられない場合、
[[c:Enumerable::Enumerator]] オブジェクトを返します。
#@end

@param min 日付オブジェクト

[[m:Date#step]] を参照してください。

--- england -> Date
このメソッドは、new_start(Date::ENGLAND) と等価です。

[[m:Date#new_start]]、および [[m:Date::ENGLAND]] を参照してください。

#@since 1.9.0
--- friday? -> bool
金曜日なら真を返します。
#@end

--- gregorian -> Date
このメソッドは、new_start(Date::GREGORIAN) と等価です。

[[m:Date#new_start]]、および [[m:Date::GREGORIAN]] を参照してください。

#@since 1.8.6
--- gregorian? -> bool
#@else
--- ns? -> bool
#@end
グレゴリオ暦なら真を返します。

#@since 1.9.0
--- iso8601 -> String
--- rfc3339 -> String
ISO 8601 書式の文字列を返します (拡大表記はつかいません)。
#@end

--- italy -> Date
このメソッドは、new_start(Date::ITALY) と等価です。

[[m:Date#new_start]]、および [[m:Date::ITALY]] を参照してください。

--- jd -> Integer
ユリウス日を返します。
時刻を含みません。

[[m:Date#ajd]] も参照してください。

#@since 1.9.0
--- jisx0301 -> String
JIS X 0301 書式の文字列を返します。
ただし、明治以前については ISO 8601 書式になります。
なお、明治6年以前についても太陰太陽暦を使用することはありません。
#@end

--- julian -> Date
このメソッドは、new_start(Date::JULIAN) と等価です。

[[m:Date#new_start]]、および [[m:Date::JULIAN]] を参照してください。

#@since 1.8.6
--- julian? -> bool
#@else
--- os? -> bool
#@end
ユリウス暦なら真を返します。

--- ld -> Integer
リリウス日を返します。

--- leap? -> bool
閏年なら真を返します。

--- mday -> Integer
--- day -> Integer
月の日を返します (1-31)。

--- mjd -> Integer
修正ユリウス日を返します。
時刻の情報を含みません。

[[m:Date#amjd]] も参照してください。

--- mon -> Integer
--- month -> Integer
月を返します (1-12)。

#@since 1.9.0
--- monday? -> bool
月曜日なら真を返します。
#@end

#@since 1.8.0
--- new_start(start = Date::ITALY) -> Date
#@else
--- newsg(start = Date::ITALY) -> Date
#@end
self を複製して、その改暦日を設定しなおします。
引数を省略した場合は、[[m:Date::ITALY]] (1582年10月15日) になります。

@param start グレゴリオ暦をつかい始めた日をあらわすユリウス日

[[m:Date.new]] も参照してください。

#@since 1.9.0
--- next_day(n = 1) -> Date
n 日後を返します。

@param n 日数をあらわす基数

[[m:Date#succ]] も参照してください。

--- next_month(n = 1) -> Date
n ヶ月後を返します。

@param n 月数をあらわす基数

[[m:Date#>>]] も参照してください。

--- next_year(n = 1) -> Date
n 年後を返します。

@param n 年数をあらわす基数

--- prev_day(n = 1) -> Date
n 日前を返します。

@param n 日数をあらわす基数

--- prev_month(n = 1) -> Date
n ヶ月前を返します。

@param n 月数をあらわす基数

[[m:Date#<<]] も参照してください。

--- prev_year(n = 1) -> Date
n 年前を返します。
#@end

@param n 年数をあらわす基数

#@since 1.9.0
--- rfc2822 -> String
--- rfc822 -> String
RFC 2822 書式の文字列を返します。
#@end

#@since 1.9.0
--- saturday? -> bool
土曜日なら真を返します。
#@end

#@since 1.8.0
--- start -> Integer
#@else
--- sg -> Integer
#@end
改暦日をあらわすユリウス日を返します。

[[m:Date.new]] も参照してください。

--- step(limit, step = 1){|date| ...} -> Date
ブロックの評価を繰り返します。ブロックは日付オブジェクトをとります。
limit は日付オブジェクトでなければなりません、
また step は非零でなければなりません。

#@since 1.9.0
1.9.0 以降では、ブロックが与えられない場合、
[[c:Enumerable::Enumerator]] オブジェクトを返します。
#@end

@param limit 日付オブジェクト
@param step 歩幅

#@since 1.9.0
--- sunday? -> bool
日曜日なら真を返します。
#@end

--- strftime(format = '%F') -> String
与えられた雛型で日付を書式づけます。
つぎの変換仕様をあつかいます:

%A, %a, %B, %b, %C, %c, %D, %d, %e, %F, %G, %g, %H, %h, %I, %j, %k, %l,
%M, %m, %n, %P, %p, %R, %r, %S, %s, %T, %t, %U, %u, %V, %v, %W, %w, %X,
%x, %Y, %y, %Z, %z, %%, %+

#@since 1.8.6
1.8.6 以降では、%L, %N, %Q もつかえます。
#@# %:{1,3}z も?
また、GNU 版にあるような幅指定などもできます。
#@else
#@# %[123]?
#@end

@param format 書式

[[man:strftime(3)]]、および [[m:Date.strptime]] も参照してください。

--- succ -> Date
--- next -> Date
翌日の日付オブジェクトを返します。

#@since 1.9.0
--- thursday? -> bool
木曜日なら真を返します。

--- to_date -> Date
対応するもっともふさわしいと思われる [[c:Date]] オブジェクトを返します。

--- to_datetime -> DateTime
対応するもっともふさわしいと思われる [[c:DateTime]] オブジェクトを返します。
#@end

--- to_s -> String
ISO 8601 書式の文字列を返します (拡大表記はつかいません)。

#@since 1.9.0
--- to_time -> Time
対応するもっともふさわしいと思われる [[c:Time]] オブジェクトを返します。

--- tuesday? -> bool
火曜日なら真を返します。
#@end

--- upto(max){|date| ...} -> Date
このメソッドは、step(max, 1){|date| ...} と等価です。

@param max 日付オブジェクト

[[m:Date#step]] を参照してください。

#@since 1.9.0
1.9.0 以降では、ブロックが与えられない場合、
[[c:Enumerable::Enumerator]] オブジェクトを返します。
#@end

--- wday -> Integer
曜日を返します (0-6、日曜日は零)。

#@since 1.9.0
--- wednesday? -> bool
水曜日なら真を返します。
#@end

--- yday -> Integer
年の日を返します (1-366)。

--- year -> Integer
年を返します。

#@since 1.9.0
= reopen Time

== Instance Methods

--- to_date -> Date
対応するもっともふさわしいと思われる [[c:Date]] オブジェクトを返します。

--- to_datetime -> DateTime
対応するもっともふさわしいと思われる [[c:DateTime]] オブジェクトを返します。

--- to_time -> Time
対応するもっともふさわしいと思われる [[c:Time]] オブジェクトを返します。
#@end
#@end
